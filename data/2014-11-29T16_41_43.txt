TITLE: Comment effacer les fichiers de configuration inutiles ?
AUTHOR: Philippe Latu
DATE: samedi 29 novembre 2014, 16:41:43 (UTC+0100)
DESC: 
FORMAT: raw
-----
BODY:
<p>Sur les systèmes Debian GNU/Linux, les outils de gestion de paquets peuvent
préserver les fichiers de configuration lors de la suppression d'un paquet.
L'idée est que l'administrateur du système puisse retrouver une configuration
personnalisée si le paquet supprimé était réinstallé par la suite.</p>

<p>Cependant, ces fichiers de configuration peuvent s'accumuler dans le temps
et finir par générer des problèmes lors des migrations d'une version stable à
l'autre. Ici, il faut insister sur le facteur temps. Retrouver des fichiers
vieux de plus de dix ans n'est pas rare sur certains serveurs comme ceux
utilisés pour l'hébergement des boîtes aux lettres de courrier électroniques.
Les migrations matérielles d'une machine à l'autre se font depuis longtemps à
l'aide de <tt>rsync</tt> et les systèmes de fichiers suivent. Il est donc utile
de «faire le ménage» dans les fichiers de configuration de paquets trop
anciens. Voici comment faire.</p>

<p>La version basée sur <tt>dpkg</tt> est connue de longue date&nbsp;:</p>

<pre># dpkg --purge $(dpkg -l | grep ^rc | cut -d ' ' -f 3 | tr '\n' ' ')</pre>

<p>Il existe maintenant une version plus moderne basée sur
<tt>aptitude</tt>&nbsp;:</p>

<pre># aptitude purge $(aptitude search ~c -F %p | sed 's/[ \t]*$//' | tr '\n' ' ')</pre>

<p>Dans les deux cas, on utilise les résultats d'une recherche des paquets dont
seule la configuration est présente sur le système. D'aucuns regretteront que
la syntaxe de mise en forme des résultats de recherche dégénère un
tantinet et que le passage de <tt>dpkg</tt> à <tt>aptitude</tt> n'apporte pas
de progrès significatif.</p>

<p>En adoptant un point de vue résolument optimiste, on peut dire que c'est une
excellente occasion d'illustrer les tubes et les commandes Unix historiques :
<tt>cut</tt>, <tt>grep</tt>, <tt>sed</tt> et <tt>tr</tt>.</p>

<p>Si vous avez une proposition de syntaxe plus optimisée pour le même
traitement, je suis preneur !</p>
END-----
