<?xml version='1.0'?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V5.0//EN"
  "/usr/share/xml/docbook/schema/dtd/5.0/docbook.dtd" [

<!ENTITY author		SYSTEM "author.xml">
<!ENTITY legal		SYSTEM "legal.xml">

<!ENTITY nas.topo	SYSTEM "files/nas.topo.txt">
<!ENTITY soho.topo	SYSTEM "files/soho.topo.txt">

<!-- urls -->
<!ENTITY % rfc_urls SYSTEM 'rfc.urls.xml'>
%rfc_urls;

<!ENTITY % inetdoc_urls SYSTEM 'inetdoc.urls.xml'>
%inetdoc_urls;

<!ENTITY url.debian-ref.network.config
   '<link xmlns="http://docbook.org/ns/docbook" xlink:href="http://qref.sourceforge.net/Debian/reference/ch-gateway.fr.html">
   <citetitle>Guide de référence pour Debian Chapitre
   10 - Configuration réseau</citetitle></link>'>

<!ENTITY url.ppp-wikipedia
   '<link xmlns="http://docbook.org/ns/docbook" xlink:href="http://en.wikipedia.org/wiki/Point-to-Point_Protocol">
   <citetitle>Point-to-Point Protocol</citetitle></link>'>

<!ENTITY url.ppp-howto
   '<link xmlns="http://docbook.org/ns/docbook" xlink:href="http://tldp.org/HOWTO/PPP-HOWTO/">
   <citetitle>Linux PPP HOWTO</citetitle></link>'>
]>

<article xml:id='interco.ppp.qa' xml:lang='fr'>

<info>
  <title>Topologie Hub &amp; Spoke avec le protocole PPP</title>

  &author;
  <abstract>
    <para>L'objectif de ce support de travaux pratiques est d'étudier les
    configurations d'un routeur d'accès (<wordasword>Hub</wordasword>) et d'un
    ou plusieurs routeurs d'agence (<wordasword>Spoke</wordasword>). On
    assimile ces deux configurations types à des routeurs qui réalisent
    l'interconnexion entre un réseau local et un réseau étendu. La technologie
    <acronym>RNIS</acronym> sert de support au réseau étendu. C'est le moyen
    d'illustrer une communication à base de trames <acronym>HDLC</acronym> et
    le fonctionnement du protocole <acronym>PPP</acronym>.</para>
  </abstract>
  <keywordset>
    <keyword>ppp</keyword>
    <keyword>ipppd</keyword>
    <keyword>isdn</keyword>
    <keyword>rnis</keyword>
    <keyword>ifconfig</keyword>
    <keyword>route</keyword>
    <keyword>chap</keyword>
    <keyword>pap</keyword>
  </keywordset>
</info>

<sect1 xml:id='interco.ppp.qa.legal.meta'>
  &legal;

  <sect2 xml:id='interco.ppp.qa.meta'>
    <title>Méta-information</title>

  <para>Cet article est écrit avec <link
  xlink:href="http://www.docbook.org"><citetitle>DocBook</citetitle></link> XML
  sur un système <link xlink:href="http://www.debian.org"><citetitle>Debian
  GNU/Linux</citetitle></link>. Il est disponible en version imprimable au
  format PDF : <link
  xlink:href="http://www.inetdoc.net/pdf/__printbasename__"><literal>__printbasename__</literal></link>.</para>

  <para>Toutes les commandes utilisées dans ce document ne sont pas spécifiques
  à une version particulière des systèmes UNIX ou GNU/Linux. C'est la
  distribution <citetitle>Debian GNU/Linux</citetitle> qui est utilisée
  pour les tests présentés. Voici une liste des paquets contenant les
  commandes :</para>

  <itemizedlist>
    <listitem>
    <para><application>net-tools</application> - The NET-3 networking
    toolkit</para>
    </listitem>
    <listitem>
    <para><application>ifupdown</application> - High level tools to configure
    network interfaces</para>
    </listitem>
    <listitem>
    <para><application>iputils-ping</application> - Tools to test the
    reachability of network hosts</para>
    </listitem>
    <listitem>
    <para><application>isdnutils</application> - Most important ISDN-related
    packages and utilities</para>
    </listitem>
    <listitem>
    <para><application>ipppd</application> - PPP daemon for syncPPP over
    ISDN</para>
    </listitem>
  </itemizedlist>
  </sect2>

  <sect2 xml:id='interco.ppp.qa.convtypo'>
    <title>Conventions typographiques</title>

  <para>Tous les exemples d'exécution des commandes sont précédés d'une invite
  utilisateur ou <wordasword>prompt</wordasword> spécifique au niveau des
  droits utilisateurs nécessaires sur le système.</para>

  <itemizedlist>
    <listitem>
    <para>Toute commande précédée de l'invite <prompt>$</prompt> ne nécessite
    aucun privilège particulier et peut être utilisée au niveau utilisateur
    simple.</para>
    </listitem>
    <listitem>
    <para>Toute commande précédée de l'invite <prompt>#</prompt> nécessite les
    privilèges du super-utilisateur.</para>
    </listitem>
  </itemizedlist>
  </sect2>
</sect1>

<sect1 xml:id='interco.ppp.qa.troubleshoot'>
  <title>Aide à la mise au point</title>

  <para>Afin de résoudre les éventuels problèmes de connexion et de
  configuration, il existe différents niveaux d'informations systèmes. Voici la
  liste des trois niveaux principaux d'émission de messages :</para>

  <variablelist>
    <varlistentry>
      <term>Messages système émis par le noyau Linux</term>
      <listitem>
      <para>L'affichage des messages système est géré par le démon <systemitem
      class='daemon'>syslogd</systemitem>. Pour consulter ces messages, il faut
      ouvrir un des fichiers du répertoire <filename
      class='directory'>/var/log/</filename>. Dans le cas des travaux
      pratiques, l'ensemble des informations nécessaires à la mise au point des
      connexions réseau se trouve dans le fichier
      <filename>/var/log/syslog</filename>. Pour visualiser les dernières
      lignes du fichier à la console on utilise la commande
      <command>tail</command> :
      <userinput>tail -50 /var/log/syslog</userinput>.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>Messages système émis par le sous-système
      <acronym>RNIS</acronym></term>
      <listitem>
      <para>Les messages du sous-système <acronym>RNIS</acronym> sont transmis
      vers les interfaces <filename>/dev/isdnctrl*</filename>. On peut les
      consulter à l'aide de la commande : <userinput>cat
      /dev/isdnctrl</userinput> ou les renvoyer automatiquement sur une
      console : <userinput>cat /dev/isdnctrl0 >/dev/tty10
      &amp;</userinput>. Les différents niveaux d'informations produits sont
      paramétrés à l'aide de l'utilitaire de contrôle du pilote d'interface
      <acronym>RNIS</acronym> : <command>hisaxctrl</command>. Ces niveaux
      sont détaillés dans les pages de manuels : <userinput>man
      hisaxctrl</userinput>. En ce qui concerne l'établissement des connexions
      téléphoniques, des codes sont renvoyés directement à la console en cas
      d'échec. Leur signification est donnée dans les pages de manuels
      <filename>isdn_cause</filename> : <userinput>man
      isdn_cause</userinput>.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>Messages émis par le gestionnaire de connexion
      <command>ipppd</command></term>
      <listitem>
      <para>Ces messages sont obtenus en configurant le démon de journalisation
      système <systemitem class='daemon'>syslogd</systemitem>. Les détails sur
      la configuration de ce démon sont obtenus à l'aide des pages de
      manuels : <userinput>man syslog.conf</userinput>. Vérifier que la
      ligne suivante est bien présente dans le fichier
      <filename>/etc/syslog.conf</filename> :
      <literallayout>daemon.*    /var/log/daemon.log</literallayout>
      </para>
      </listitem>
    </varlistentry>
  </variablelist>
</sect1>

<sect1 xml:id='interco.ppp.qa.isdn'>
  <title>Interface RNIS &amp; protocole PPP</title>

  <para>La connexion directe à l'aide du mode <option>rawip</option> (Voir
  &url.interco.rawip;) présente l'avantage de la simplicité : authentification
  basée sur les numéros de téléphone sans échange d'adresses IP. Ce mode de
  connexion présente cependant des limitations importantes.</para>

  <itemizedlist>
    <listitem>
    <para>La configuration des adresses IP doit être effectuée avant
    l'établissement de la connexion téléphonique. Il est donc impératif que les
    postes soient en état de marche au moment de la connexion.</para>
    </listitem>
    <listitem>
    <para>La sécurité de connexion étant basée sur les numéros de téléphone, il
    est impossible de se connecter depuis une autre installation.</para>
    </listitem>
    <listitem>
    <para>Comme la configuration réseau est effectuée manuellement à chaque
    extrémité, le plan d'adressage <acronym>IP</acronym> doit être connu de
    toutes les entités en communication.</para>
    </listitem>
  </itemizedlist>

  <para>Le protocole <acronym>PPP</acronym> permet de dépasser ces limitations
  en offrant une configuration indépendante de la technologie du réseau étendu
  après authentification et autorise une plus grande mobilité.</para>

  <para>Les mécanismes de fonctionnement de ce protocole sont décrits dans le
  document &url.rfc1661;. Dans le contexte de ces travaux pratiques, il doit
  remplir trois fonctions pour les deux configurations types
  étudiées :</para>

  <itemizedlist>
    <listitem>
    <para>La possibilité de se connecter au serveur d'appel depuis n'importe
    quel poste ou numéro de téléphone.</para>
    </listitem>
    <listitem>
    <para>L'authentification de l'utilisateur appelant.</para>
    </listitem>
    <listitem>
    <para>L'attribution de l'adresse IP du poste appelant.</para>
    </listitem>
  </itemizedlist>

  <para>Relativement à la configuration <option>rawip</option>, il faut changer
  quelques paramètres de configuration au niveau liaison de l'interface
  <acronym>RNIS</acronym>.</para>

  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para><phrase>Quelle est l'encapsulation à configurer sur l'interface
      <acronym>RNIS</acronym> pour utiliser le protocole <acronym>PPP</acronym>
      ?</phrase></para>

      <para>Consulter les pages de manuels de la commande
      <command>isdnctrl</command> en effectuant une recherche avec la
      clé : <literal>ppp</literal>.</para>
      </question>
      <answer>
      <para>L'option recherchée dans les pages de manuels est :
      <option>syncppp</option>.</para>
      </answer>
    </qandaentry>
    <qandaentry>
      <question>
      <para><phrase>Quel est le démon de gestion de connexion qui utilise le
      mode de transmission synchrone des interfaces <acronym>RNIS</acronym>
      avec le protocole <acronym>PPP</acronym> ?</phrase></para>

      <para>Lister les paquets liés au sous-système
      (<acronym>RNIS</acronym>|<acronym>ISDN</acronym>) et retrouver le
      gestionnaire de connexion associé.</para>
      </question>
      <answer>
      <para>On peut, par exemple;, effectuer la recherche suivante.</para>

<screen width='80'><prompt>$</prompt> aptitude search ppp | grep -i isdn
p   ipppd              - ISDN utilities - PPP daemon
p   pppdcapiplugin     - ISDN utilities - pppd plug-in for CAPI sup</screen>

      <para>C'est le paquet <systemitem>ipppd</systemitem> qui contient le
      démon du même nom qui correspond à l'utilisation du sous-système
      <acronym>RNIS</acronym> du noyau Linux.</para>
      </answer>
    </qandaentry>
    <qandaentry>
      <question>
      <para><phrase>Quelles sont les noms d'interface <acronym>RNIS</acronym> à
      utiliser avec ce démon de gestion de connexion ?</phrase></para>

      <para>Voir les pages de manuels de l'outil de configuration d'interface
      <command>isdnctrl</command>.</para>
      </question>
      <answer>
      <para>Le sous-système <acronym>RNIS</acronym> du noyau Linux dispose
      d'entrées spécifiques par type de communication. L'utilisation du démon
      <systemitem>ipppd</systemitem> impose une communication via un
      descripteur de périphérique nommé <option>/dev/ipppX</option> où
      <keycap>X</keycap> désigne un numéro d'interface.</para>
      </answer>
    </qandaentry>
  </qandaset>
</sect1>

<sect1 xml:id='interco.ppp.qa.ppp-protocol'>
  <title>Connexion avec le protocole PPP</title>

  <para>Pour valider le fonctionnement de l'interface <acronym>RNIS</acronym>
  avec le protocole <acronym>PPP</acronym>, on utilise les postes de travaux
  pratiques par paires. Dans ce contexte, les deux modes : client et
  serveur ne se distinguent que par l'attribution d'adresses IP.</para>

  <mediaobject>
  <imageobject>
    <imagedata fileref='images/interco.ppp.topology0.png' format='PNG' width='9cm' scalefit='1'/>
  </imageobject>
  <textobject>
    <phrase>Topologie équivalente entre serveur et client
    <acronym>PPP</acronym></phrase>
  </textobject>
  <caption>
    <para><link xlink:href='images/interco.ppp.topology0.png'>Topologie
    équivalente entre serveur et client <acronym>PPP</acronym></link></para>
  </caption>
  </mediaobject>

  <para>C'est le serveur qui doit fournir les adresses données dans le tableau
  ci-dessous.</para>

  <table xml:id='addressing' frame='all' pgwide='1'>
    <title>Plans d'adressage IP et RNIS des liaisons WAN</title>
    <tgroup cols='6'>
      <colspec colnum='1' colwidth='1*'/>
      <colspec colnum='2' colwidth='3*'/>
      <colspec colnum='3' colwidth='1*'/>
      <colspec colnum='4' colwidth='5*'/>
      <colspec colnum='5' colwidth='1*'/>
      <colspec colnum='6' colwidth='3*'/>
    <thead>
      <row>
      <entry>Bus</entry>
      <entry>Serveur PPP</entry>
      <entry>N° tél.</entry>
      <entry>Adresses IP serveur:client</entry>
      <entry>N° tél.</entry>
      <entry>Client PPP</entry>
      </row>
    </thead>
    <tbody>
      <row>
      <entry>S0.1</entry>
      <entry>alderaan</entry>
      <entry>104</entry>
      <entry><systemitem class='ipaddress'>192.168.104.1:192.168.105.2</systemitem></entry>
      <entry>105</entry>
      <entry>bespin</entry>
      </row>
      <row>
      <entry>S0.2</entry>
      <entry>centares</entry>
      <entry>106</entry>
      <entry><systemitem class='ipaddress'>192.168.106.1:192.168.107.2</systemitem></entry>
      <entry>107</entry>
      <entry>coruscant</entry>
      </row>
      <row>
      <entry>S0.3</entry>
      <entry>dagobah</entry>
      <entry>108</entry>
      <entry><systemitem class='ipaddress'>192.168.108.1:192.168.109.2</systemitem></entry>
      <entry>109</entry>
      <entry>endor</entry>
      </row>
      <row>
      <entry>S0.4</entry>
      <entry>felucia</entry>
      <entry>110</entry>
      <entry><systemitem class='ipaddress'>192.168.110.1:192.168.111.2</systemitem></entry>
      <entry>111</entry>
      <entry>geonosis</entry>
      </row>
      <row>
      <entry>S0.5</entry>
      <entry>hoth</entry>
      <entry>112</entry>
      <entry><systemitem class='ipaddress'>192.168.112.1:192.168.113.2</systemitem></entry>
      <entry>113</entry>
      <entry>mustafar</entry>
      </row>
      <row>
      <entry>S0.6</entry>
      <entry>naboo</entry>
      <entry>114</entry>
      <entry><systemitem class='ipaddress'>192.168.114.1:192.168.115.2</systemitem></entry>
      <entry>115</entry>
      <entry>tatooine</entry> 
      </row>
    </tbody>
    </tgroup>
  </table>

  <para>Attention, les adresses données dans ce tableau étant utilisées par des
  liens point à point, le masque réseau occupe les 32 bits de l'espace
  d'adressage.</para>

  <note>
    <title>Saisie des options du démon PPP</title>
    <para>Pour l'ensemble de ces travaux pratiques, les options du gestionnaire
    de connexion <acronym>PPP</acronym> <command>ipppd</command> doivent être
    saisies directement sur la ligne de commande. Il faut s'assurer que les
    fichiers <filename>/etc/ppp/ioptions*</filename> sont vides. Dans le cas
    contraire, les paramètres contenus dans ces fichiers peuvent être utilisés
    par défaut sans tenir compte de ceux saisis sur la ligne de
    commande.</para>
  </note>

  <sect2 xml:id='interco.ppp.qa.ppp-protocol.noauth'>
    <title>Sans authentification</title>

  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para><phrase>Quelles sont les options de configuration à fournir au
      gestionnaire de connexion pour ce mode de fonctionnement
      ?</phrase></para>

      <para>Consulter les pages de manuels du démon
      <command>ipppd</command>.</para>
      </question>
      <answer>
      <para>Le protocole <acronym>PPP</acronym> n'a pas été conçu suivant le
      modèle Client/Serveur. Il suppose que deux processus pairs échangent des
      informations. Pour cette question c'est l'option <option>auth</option>
      qui définit si un hôte requiert une authentification de l'hôte pair.
      Cette authentification peut être requise par chacune des extrémités en
      communication. Pour désactiver l'authentification à chaque extrémité, on
      ajoute le préfixe <option>no</option> à l'option
      <option>auth</option>.</para>
      </answer>
    </qandaentry>
    
    <qandaentry>
      <question>
      <para><phrase>Quelles sont les options qui permettent de visualiser en
      détails le dialogue <acronym>PPP</acronym> dans les journaux systèmes
      ?</phrase></para>

      <para>C'est à nouveau dans les pages de manuels que la réponse se
      trouve.</para>
      </question>
      <answer>
      <para>C'est l'option <option>debug</option> qui permet l'affichage des
      informations relatives aux différentes étapes de l'établissement de la
      connexion <acronym>PPP</acronym>.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quels sont les noms des deux sous-couches du protocole
      <acronym>PPP</acronym> qui apparaissent dans les journaux systèmes
      ?</phrase> Quels sont les rôles respectifs de ces deux sous-couches
      ?</para>

      <para>Consulter la page &url.ppp-wikipedia;.</para>
      </question>
      <answer>
      <para>La consultation des journaux système fait apparaître les
      informations suivantes.</para>

<screen width='80'>pppd[3262]: sent [LCP ConfReq id=0x1 &lt;mru 1492> &lt;magic 0x46010ac>]
kernel: [  895.700115] NET: Registered protocol family 24
pppd[3262]: rcvd [LCP ConfReq id=0x1 &lt;magic 0xcab9fecc>] <co xml:id='lcp'/>
pppd[3262]: sent [LCP ConfAck id=0x1 &lt;magic 0xcab9fecc>]
pppd[3262]: sent [LCP ConfReq id=0x1 &lt;mru 1492> &lt;magic 0x46010ac>]
pppd[3262]: rcvd [LCP ConfAck id=0x1 &lt;mru 1492> &lt;magic 0x46010ac>]
pppd[3262]: sent [LCP EchoReq id=0x0 magic=0x46010ac]
pppd[3262]: peer from calling number 52:54:00:12:34:05 authorized
pppd[3262]: sent [IPCP ConfReq id=0x1 &lt;addr 0.0.0.0>] <co xml:id='ncp'/>
pppd[3262]: rcvd [LCP EchoReq id=0x0 magic=0xcab9fecc]
pppd[3262]: sent [LCP EchoRep id=0x0 magic=0x46010ac]
pppd[3262]: rcvd [IPCP ConfReq id=0x1 &lt;addr 10.0.0.1>]
pppd[3262]: sent [IPCP ConfAck id=0x1 &lt;addr 10.0.0.1>]
pppd[3262]: rcvd [LCP EchoRep id=0x0 magic=0xcab9fecc]
pppd[3262]: rcvd [IPCP ConfNak id=0x1 &lt;addr 10.67.15.1>]
pppd[3262]: sent [IPCP ConfReq id=0x2 &lt;addr 10.67.15.1>]
pppd[3262]: rcvd [IPCP ConfAck id=0x2 &lt;addr 10.67.15.1>]
pppd[3262]: local  IP address 10.67.15.1
pppd[3262]: remote IP address 10.0.0.1</screen>

      <calloutlist>
        <callout arearefs='lcp'>
	<para>La sous-couche <wordasword>Link Control Protocol</wordasword>
	(<acronym>LCP</acronym>) assure la configuration automatique des
	interfaces à chaque extrémité. Les paramètres négociés entre les deux
	hôtes en communication sont multiples : l'adaptation de la taille de
	datagramme, les caractères d'échappement, les numéros magiques et la
	sélection des options d'authentification.</para>
	</callout>
	<callout arearefs='ncp'>
	<para>La sous-couche <wordasword>Network Control Protocol</wordasword>
	(<acronym>NCP</acronym>) assure l'encapsulation de multiples protocoles
	de la couche réseau. Dans l'exemple donné, c'est le protocole
	<acronym>IP</acronym> qui est utilisé ; d'où l'acronyme
	<acronym>IPCP</acronym>.</para>
	</callout>
      </calloutlist>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quels sont les en-têtes du dialogue qui identifient les
      requêtes (émises|reçues), les rejets et les acquittements
      ?</phrase></para>

      <para>Consulter les journaux système contenant les traces d'une connexion
      <acronym>PPP</acronym>.</para>
      </question>
      <answer>
      <para>La copie d'écran donnée ci-dessus fait apparaître les directives
      <literal>Conf*</literal> pour chaque paramètre négocié.</para>
      <itemizedlist>
      <listitem>
      <para><literal>ConfReq</literal> indique une requête.</para>
      </listitem>
      <listitem>
      <para><literal>ConfAck</literal> indique un acquittement.</para>
      </listitem>
      <listitem>
      <para><literal>ConfNak</literal> indique un rejet.</para>
      </listitem>
      </itemizedlist>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>

  <sect2 xml:id='interco.ppp.qa.protocol.client.authpap'>
    <title>Avec authentification PAP</title>

  <para>Relativement à la section précédente, on ajoute ici le volet
  authentification au dialogue <acronym>PPP</acronym> en utilisant le protocole
  <acronym>PAP</acronym>.</para>

  <para>Pour l'ensemble des postes de travaux pratiques les paramètres
  d'authentification <wordasword>login/password</wordasword> sont :
  <option>etu/stri</option>.</para>

  <note>
    <title>Journalisation des échanges de mots de passe</title>
    <para>Il existe une option spécifique du gestionnaire de connexion
    <acronym>PPP</acronym> <application>ipppd</application> qui permet de
    journaliser les échanges sur les mots de passe :
    <option>+pwlog</option>. En ajoutant cette option à celles déjà utilisées
    lors de l'appel à <application>ipppd</application> sur la ligne de
    commande, on peut observer l'état des transactions
    d'authentification.</para>
  </note>

  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para><phrase>Quelles sont les options de configuration spécifiques à
      l'authentification <acronym>PAP</acronym> à fournir au démon
      <acronym>PPP</acronym> ?</phrase></para>

      <para>Consulter les pages de manuels du démon
      <command>ipppd</command>.</para>
      </question>
      <answer>
      <para>C'est l'option <option>pap</option> qui permet de spécifier ce type
      d'authentification.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Dans quel fichier sont stockés les paramètres
      d'authentification <wordasword>login/password</wordasword> utilisés par
      le protocole <acronym>PAP</acronym> ?</phrase></para>

      <para>Consulter les pages de manuels du démon
      <command>ipppd</command>.</para>
      </question>
      <answer>
      <para>C'est le fichier <filename>/etc/ppp/pap-secrets</filename> qui
      contient les couples <wordasword>login/password</wordasword> utilisés
      lors de l'authentification.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quels sont les en-têtes du dialogue de la couche
      <acronym>LCP</acronym> qui identifient les requêtes d'authentification
      échangées entre les deux processus pairs ?</phrase></para>
      </question>
      <answer>
      <para>Voici une copie d'écran de connexion qui fait apparaître les
      directives <literal>Conf*</literal> relatives à la partie
      authentification.</para>

<screen width='80'>pppd[5259]: sent [LCP ConfReq id=0x1 &lt;auth pap> &lt;magic 0x53c04a36>]
pppd[5259]: rcvd [LCP ConfAck id=0x1 &lt;auth pap> &lt;magic 0x53c04a36>]
pppd[5259]: rcvd [LCP ConfReq id=0x1 &lt;mru 1492> &lt;magic 0x3f810ce9>]
pppd[5259]: sent [LCP ConfAck id=0x1 &lt;mru 1492> &lt;magic 0x3f810ce9>]
pppd[5259]: sent [LCP EchoReq id=0x0 magic=0x53c04a36]
pppd[5259]: rcvd [LCP EchoReq id=0x0 magic=0x3f810ce9]
pppd[5259]: sent [LCP EchoRep id=0x0 magic=0x53c04a36]
pppd[5259]: rcvd [PAP AuthReq id=0x1 user="etu" password=&lt;hidden>]</screen>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quelles sont les informations échangées sur les mots de
      passe avec le protocole <acronym>PAP</acronym> ?</phrase> Est-il possible
      de relever le mot de passe avec ce protocole ?</para>
      </question>
      <answer>
      <para>L'utilisation de la méthode d'authentification
      <acronym>PAP</acronym> implique que le mot de passe circule en clair. Une
      simple capture du trafic permet de «relever» le mot de passe.</para>

      <para>Voici un extrait de capture réseau effectué avec le démon
      <systemitem>pppd</systemitem> à l'aide de la commande
      <userinput><prompt>#</prompt> tshark -V -i eth0 -R "ppp" >
      grepMyPassword.txt</userinput>.</para>

<screen width='80'>Type: PPPoE Session (0x8864)
PPP-over-Ethernet Session
    0001 .... = Version: 1
    .... 0001 = Type: 1
    Code: Session Data (0x00)
    Session ID: 0x0003
    Payload Length: 16
Point-to-Point Protocol
    Protocol: Password Authentication Protocol (0xc023)
PPP Password Authentication Protocol
    Code: Authenticate-Request (1)
    Identifier: 1
    Length: 14
    Data
        Peer-ID-Length: 3
        Peer-ID: etu
        Password-Length: 5
        <emphasis>Password: stri</emphasis></screen>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>

  <sect2 xml:id='interco.ppp.qa.protocol.client.authchap'>
    <title>Avec authentification CHAP</title>

  <para>On reprend exactement le cas précédent en changeant le protocole
  d'authentification. On utilise maintenant le protocole <acronym>CHAP</acronym>
  qui est nettement plus intéressant que <acronym>PAP</acronym>. Nous allons
  voir pourquoi !</para>

  <para>Les paramètres d'authentification
  <wordasword>login/password</wordasword> ne changent pas :
  <option>etu/stri</option>.</para>

  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para><phrase>Quelles sont les options de configuration spécifiques à
      l'authentification <acronym>CHAP</acronym> à fournir au démon PPP
      ?</phrase></para>

      <para>Consulter les pages de manuels du démon
      <command>ipppd</command>.</para>
      </question>
      <answer>
      <para>C'est l'option <option>chap</option> qui permet de spécifier ce
      type d'authentification.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Dans quel fichier sont stockés les paramètres
      d'authentification <wordasword>login/password</wordasword> utilisés par
      le protocole <acronym>CHAP</acronym> ?</phrase></para>

      <para>Consulter les pages de manuels du démon
      <command>ipppd</command>.</para>
      </question>
      <answer>
      <para>C'est le fichier <filename>/etc/ppp/chap-secrets</filename> qui
      contient les couples <wordasword>login/password</wordasword> utilisés
      lors de l'authentification.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quels sont les en-têtes du dialogue de la couche
      <acronym>LCP</acronym> qui identifient les requêtes d'authentification
      échangées entre les deux processus pairs ?</phrase></para>
      </question>
      <answer>
      <para>Voici une copie d'écran de connexion qui fait apparaître les
      directives <literal>Conf*</literal> relatives à la partie
      authentification.</para>

<screen width='80'>pppd[6037]: pppd 2.4.5 started by root, uid 0
pppd[6037]: using channel 28
pppd[6037]: Using interface ppp0
pppd[6037]: Connect: ppp0 &lt; /dev/pts/1
pppd[6037]: sent [LCP ConfReq id=0x1 &lt;auth chap MD5> &lt;magic 0x46c97184>]
pppd[6037]: rcvd [LCP ConfAck id=0x1 &lt;auth chap MD5> &lt;magic 0x46c97184>]
pppd[6037]: rcvd [LCP ConfReq id=0x1 &lt;mru 1492> &lt;auth chap MD5> &lt;magic 0x1f157ebf>]
pppd[6037]: sent [LCP ConfAck id=0x1 &lt;mru 1492> &lt;auth chap MD5> &lt;magic 0x1f157ebf>]
pppd[6037]: sent [LCP EchoReq id=0x0 magic=0x46c97184]
pppd[6037]: sent [CHAP Challenge id=0x86 &lt;ed6d9c0c022dbe008b2d3332fb275f5af1ca499393>, name = "ppp-hub"]
pppd[6037]: rcvd [LCP EchoReq id=0x0 magic=0x1f157ebf]
pppd[6037]: sent [LCP EchoRep id=0x0 magic=0x46c97184]
pppd[6037]: rcvd [CHAP Challenge id=0x4f &lt;29b6227da7da53d7ee2b4f6f7ec9a1900d5c9ac33f14>, name = "etu"]
pppd[6037]: sent [CHAP Response id=0x4f &lt;cb5bf4fbb0f9afd98a477f1f8a2e4c1f>, name = "etu"]
pppd[6037]: rcvd [LCP EchoRep id=0x0 magic=0x1f157ebf]
pppd[6037]: rcvd [CHAP Response id=0x86 &lt;de265c472d38a441fdbd2228314e0d86>, name = "etu"]
pppd[6037]: sent [CHAP Success id=0x86 "Access granted"]
pppd[6037]: rcvd [CHAP Success id=0x4f "Access granted"]
pppd[6037]: CHAP authentication succeeded: Access granted
pppd[6037]: CHAP authentication succeeded</screen>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quelles sont les informations échangées sur les mots de
      passe avec le protocole <acronym>CHAP</acronym> ?</phrase> Est-il
      possible de relever le mot de passe avec ce protocole ?</para>
      </question>
      <answer>
      <para>Les éléments donnés dans le copie d'écran ci-dessus montrent qu'il
      n'y a pas d'échange de mot de passe entre les deux systèmes en
      communication. Seuls des <wordasword>Challenges</wordasword> sont
      échangés.</para>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>
</sect1>

<sect1 xml:id='interco.ppp.qa.hub-and-spoke'>
  <title>Topologie Hub &amp; Spoke</title>

  <para>La topologie dite <wordasword>Hub &amp; Spoke</wordasword> est une
  forme de topologie étoile dans laquelle tous les liens sont de type point à
  point. Le rôle du <wordasword>Hub</wordasword> est de concentrer tous les
  accès depuis les sites distants ou les <wordasword>Spokes</wordasword>. Du
  point de vue routage le <wordasword>Hub</wordasword> détient la totalité du
  plan d'adressage alors que les <wordasword>Spokes</wordasword> ne disposent
  que d'un accès unique vers les autres réseaux.</para>

  <mediaobject>
  <imageobject>
    <imagedata fileref='images/interco.ppp.topology1.png' format='PNG' width='12cm' scalefit='1'/>
  </imageobject>
  <textobject>
    <phrase>Topologie Hub &amp; Spoke</phrase>
  </textobject>
  <caption>
    <para><link xlink:href='images/interco.ppp.topology1.png'>Topologie Hub
    &amp; Spoke</link></para>
  </caption>
  </mediaobject>

  <para>Dans le contexte de ces travaux pratiques, le routeur
  <wordasword>Hub</wordasword> dispose d'un accès au réseau local
  (<acronym>LAN</acronym>) via son interface Ethernet et doit fournir un accès
  à Internet par ses interfaces d'accès au réseau étendu
  (<acronym>WAN</acronym>). Ce réseau étendu est modélisé par les deux canaux B
  de l'interface <acronym>RNIS</acronym> du <wordasword>Hub</wordasword>. Côté
  <wordasword>Spokes</wordasword>, les interfaces Ethernet sont provisoirement
  inutilisées et le seul accès aux autres réseau se fait par un canal B de
  l'interface <acronym>RNIS</acronym>.</para>
  
  <sect2 xml:id='interco.ppp.qa.hub-and-spoke.default-route'>
    <title>Établissement de la route par défaut</title>
    
    <para>La configuration par défaut des paquets
    <application>*pppd*</application> suppose que le poste utilisé est un
    client pour lequel la route par défaut doit être établie à chaque nouvelle
    connexion <acronym>PPP</acronym>.</para>
    <para>Dans le cas présent, le routeur d'accès
    (<wordasword>Hub</wordasword>) doit conserver sa route par défaut sur le
    réseau local indépendamment des demandes de connexion
    <acronym>PPP</acronym>. Il est donc nécessaire de modifier le script de
    connexion <filename>/etc/ppp/ip-up.d/00-ipppd</filename>. Voici un extrait
    avec les lignes à commenter :</para>

<screen width='80'>PPP_NET=`echo $PPP_LOCAL | sed 's,\.[0-9]*\.[0-9]*$,.0.0/16,'`

case "$PPP_IFACE" in
	ippp0)  route del default  <co xml:id='default.del' />
                # route add default netmask 0 $PPP_IFACE   # usually necessary
                route add default netmask 0 gw $PPP_REMOTE <co xml:id='default.add' />
                # The next lines are for simple firewalling.</screen>

    <calloutlist>
      <callout arearefs='default.del'>
      <para>Commenter cette ligne pour éviter l'effacement de la route par
      défaut.</para>
      </callout>
      <callout arearefs='default.add'>
      <para>Commenter cette ligne pour éviter l'établissement d'une nouvelle
      route par défaut.</para>
      </callout>
    </calloutlist>
  </sect2>

  <sect2 xml:id='interco.ppp.qa.hub-and-spoke.addressing'>
    <title>Plan d'adressage</title>

  <para>Pour mettre en œuvre la topologie voulue, on distingue 4 groupes de 3
  postes de travaux pratiques. Le rôle de chaque poste est défini dans le
  tableau ci-dessous.</para>

  <table xml:id='lab.addressing' frame='all' pgwide='1'>
    <title>Affectation des rôles, des numéros de bus S0 et des adresses
    IP</title>
    <tgroup cols='7' align='left' colsep='1' rowsep='1'>
    <colspec colnum='1' colwidth='1*'/>
    <colspec colnum='2' colwidth='1.5*'/>
    <colspec colnum='3' colwidth='1*'/>
    <colspec colnum='4' colwidth='1*'/>
    <colspec colnum='5' colwidth='1*'/>
    <colspec colnum='6' colwidth='1*'/>
    <colspec colnum='7' colwidth='3*'/>
    <thead>
      <row>
      <entry>Groupe</entry>
      <entry>Poste</entry>
      <entry>Rôle</entry>
      <entry>Bus S0</entry>
      <entry>N° Tél.</entry>
      <entry>Interface</entry>
      <entry>Réseau/Authentification</entry>
      </row>
    </thead>
    <tbody>
      <row>
      <entry morerows='5' valign='middle'>1</entry>
      <entry morerows='1' valign='middle'>centares</entry>
      <entry morerows='1' valign='middle'>Hub</entry>
      <entry align='right'>S0.1</entry>
      <entry>104</entry>
      <entry>ippp0</entry>
      <entry><systemitem class='ipaddress'>192.168.104.1:192.168.104.2</systemitem></entry>
      </row>
      <row>
      <entry align='right'>S0.1</entry>
      <entry>105</entry>
      <entry>ippp1</entry>
      <entry><systemitem class='ipaddress'>192.168.105.1:192.168.105.2</systemitem></entry>
      </row>
      <row>
      <entry morerows='1' valign='middle'>bespin</entry>
      <entry morerows='1' valign='middle'>Spoke 1</entry>
      <entry align='right'>S0.2</entry>
      <entry>106</entry>
      <entry>ippp0</entry>
      <entry align='center'><systemitem>etu_s1 / Sp0k3.1</systemitem></entry>
      </row>
      <row>
      <entry>-</entry>
      <entry>-</entry>
      <entry>dummy0</entry>
      <entry><systemitem class='ipaddress'>10.106.0.1/29</systemitem></entry>
      </row>
      <row>
      <entry morerows='1' valign='middle'>alderaan</entry>
      <entry morerows='1' valign='middle'>Spoke 2</entry>
      <entry align='right'>S0.2</entry>
      <entry>107</entry>
      <entry>ippp0</entry>
      <entry align='center'><systemitem>etu_s2 / Sp0k3.2</systemitem></entry>
      </row>
      <row>
      <entry>-</entry>
      <entry>-</entry>
      <entry>dummy0</entry>
      <entry><systemitem class='ipaddress'>10.107.0.1/29</systemitem></entry>
      </row>
      <row>
      <entry morerows='5' valign='middle'>2</entry>
      <entry morerows='1' valign='middle'>endor</entry>
      <entry morerows='1' valign='middle'>Hub</entry>
      <entry align='right'>S0.3</entry>
      <entry>108</entry>
      <entry>ippp0</entry>
      <entry><systemitem class='ipaddress'>192.168.107.1:192.168.107.2</systemitem></entry>
      </row>
      <row>
      <entry align='right'>S0.3</entry>
      <entry>109</entry>
      <entry>ippp1</entry>
      <entry><systemitem class='ipaddress'>192.168.108.1:192.168.108.2</systemitem></entry>
      </row>
      <row>
      <entry morerows='1' valign='middle'>dagobah</entry>
      <entry morerows='1' valign='middle'>Spoke 1</entry>
      <entry align='right'>S0.4</entry>
      <entry>110</entry>
      <entry>ippp0</entry>
      <entry align='center'><systemitem>etu_s1 / Sp0k3.1</systemitem></entry>
      </row>
      <row>
      <entry>-</entry>
      <entry>-</entry>
      <entry>dummy0</entry>
      <entry><systemitem class='ipaddress'>10.109.0.1/29</systemitem></entry>
      </row>
      <row>
      <entry morerows='1' valign='middle'>coruscant</entry>
      <entry morerows='1' valign='middle'>Spoke 2</entry>
      <entry align='right'>S0.4</entry>
      <entry>111</entry>
      <entry>ippp0</entry>
      <entry align='center'><systemitem>etu_s2 / Sp0k3.2</systemitem></entry>
      </row>
      <row>
      <entry>-</entry>
      <entry>-</entry>
      <entry>dummy0</entry>
      <entry><systemitem class='ipaddress'>10.110.0.1/29</systemitem></entry>
      </row>
      <row>
      <entry morerows='5' valign='middle'>3</entry>
      <entry morerows='1' valign='middle'>hoth</entry>
      <entry morerows='1' valign='middle'>Hub</entry>
      <entry align='right'>S0.5</entry>
      <entry>112</entry>
      <entry>ippp0</entry>
      <entry><systemitem class='ipaddress'>192.168.111.1:192.168.111.2</systemitem></entry>
      </row>
      <row>
      <entry align='right'>S0.5</entry>
      <entry>113</entry>
      <entry>ippp1</entry>
      <entry><systemitem class='ipaddress'>192.168.112.1:192.168.112.2</systemitem></entry>
      </row>
      <row>
      <entry morerows='1' valign='middle'>geonosis</entry>
      <entry morerows='1' valign='middle'>Spoke 1</entry>
      <entry align='right'>S0.6</entry>
      <entry>114</entry>
      <entry>ippp0</entry>
      <entry align='center'><systemitem>etu_s1 / Sp0k3.1</systemitem></entry>
      </row>
      <row>
      <entry>-</entry>
      <entry>-</entry>
      <entry>dummy0</entry>
      <entry><systemitem class='ipaddress'>10.113.0.1/29</systemitem></entry>
      </row>
      <row>
      <entry morerows='1' valign='middle'>felucia</entry>
      <entry morerows='1' valign='middle'>Spoke 2</entry>
      <entry align='right'>S0.6</entry>
      <entry>115</entry>
      <entry>ippp0</entry>
      <entry align='center'><systemitem>etu_s2 / Sp0k3.2</systemitem></entry>
      </row>
      <row>
      <entry>-</entry>
      <entry>-</entry>
      <entry>dummy0</entry>
      <entry><systemitem class='ipaddress'>10.114.0.1/29</systemitem></entry>
      </row>
      <row>
      <entry morerows='5' valign='middle'>4</entry>
      <entry morerows='1' valign='middle'>naboo</entry>
      <entry morerows='1' valign='middle'>Hub</entry>
      <entry align='right'>S0.7</entry>
      <entry>116</entry>
      <entry>ippp0</entry>
      <entry><systemitem class='ipaddress'>192.168.115.1:192.168.115.2</systemitem></entry>
      </row>
      <row>
      <entry align='right'>S0.7</entry>
      <entry>117</entry>
      <entry>ippp1</entry>
      <entry><systemitem class='ipaddress'>192.168.116.1:192.168.116.2</systemitem></entry>
      </row>
      <row>
      <entry morerows='1' valign='middle'>mustafar</entry>
      <entry morerows='1' valign='middle'>Spoke 1</entry>
      <entry align='right'>S0.8</entry>
      <entry>118</entry>
      <entry>ippp0</entry>
      <entry align='center'><systemitem>etu_s1 / Sp0k3.1</systemitem></entry>
      </row>
      <row>
      <entry>-</entry>
      <entry>-</entry>
      <entry>dummy0</entry>
      <entry><systemitem class='ipaddress'>10.117.0.1/29</systemitem></entry>
      </row>
      <row>
      <entry morerows='1' valign='middle'>tatooine</entry>
      <entry morerows='1' valign='middle'>Spoke 2</entry>
      <entry align='right'>S0.8</entry>
      <entry>119</entry>
      <entry>ippp0</entry>
      <entry align='center'><systemitem>etu_s2 / Sp0k3.2</systemitem></entry>
      </row>
      <row>
      <entry>-</entry>
      <entry>-</entry>
      <entry>dummy0</entry>
      <entry><systemitem class='ipaddress'>10.118.0.1/29</systemitem></entry>
      </row>
    </tbody>
    </tgroup>
  </table>

  <para>Comme dans le tableau d'adressage précédent, les adresses données
  ci-dessus étant utilisées par des liens point à point, le masque réseau
  occupe les 32 bits de l'espace d'adressage.</para>

  <warning>
  <para>Les connexions <acronym>RNIS</acronym> des routeurs
  (<wordasword>Hubs</wordasword> doivent se faire directement sur les ports de
  l'autocommutateur <acronym>RNIS</acronym>. En effet, ces connexions utilisent
  les deux canaux B du port <acronym>BRI</acronym>.</para>
  </warning>
  </sect2>
</sect1>


<sect1 xml:id='interco.ppp.qa.hub'>
  <title>Configuration du routeur Hub</title>

  <para>Compte tenu de la topologie définie dans la section précédente, on doit
  configurer les interfaces <acronym>LAN</acronym> et <acronym>WAN</acronym> du
  <wordasword>Hub</wordasword>. Ce routeur doit fournir l'accès Internet via
  son interface <acronym>LAN</acronym> et attribuer les adresses
  <acronym>IP</acronym> aux <wordasword>Spokes</wordasword> via ses interfaces
  <acronym>WAN</acronym>.</para>

  <sect2 xml:id='interco.ppp.qa.hub.lan'>
    <title>Connexion au réseau local</title>

  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para><phrase>Comment activer le routage au niveau dans le noyau du
      routeur ?</phrase></para>
      
      <para>Consulter les documentations &url.config.interface.lan; et
      &url.nat-howto;.</para>
      </question>
      <answer>
      <para>Les paramètres de réglage des fonctions réseau du noyau Linux sont
      situés dans l'arborescence <filename class='directory'>/proc</filename>.
      Le paramètre qui nous intéresse est <option>ip_forward.</option>. Par
      défaut, sa valeur est à <option>0</option> et le routage est désactivé
      dans le noyau. On doit donc passer cette valeur à <option>1</option> pour
      activer le routage.</para>
 
<screen width='80'><prompt>#</prompt> echo 1 > /proc/sys/net/ipv4/ip_forward</screen>

      <para>Pour rendre ce réglage permanent, il est possible d'éditer le
      fichier <filename>/etc/sysctl.conf</filename>. De cette façon, le routage
      sera activé à chaque redémarrage du système. Dans le cadre des travaux
      pratiques, ce n'est pas nécessaire.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quelles sont les opérations nécessaires à la configuration
      de la traduction des adresses sources des paquets sortant par
      l'interface LAN ?</phrase></para>
      
      <para>Consulter la documentation &url.nat-howto;.</para>
      </question>
      <answer>
      <para>On utilise ici la méthode de traduction d'adresses sources la plus
      simple. Elle est connue sous le nom de
      <wordasword>masquerading</wordasword>.</para>
 
<screen width='80'><prompt>#</prompt> iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</screen>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quels sont les tests à réaliser pour s'assurer du
      fonctionnement de l'accès Internet ?</phrase></para>

      <para>Consulter la documentation &url.config.interface.lan;.</para>
      </question>
      <answer>
      <para>Les tests peuvent se décomposer en deux parties : l'utilisation du
      protocole <acronym>ICMP</acronym> et l'analyse réseau.</para>

      <para>Avec <acronym>ICMP</acronym>, il faut reprendre la séquence
      «rituelle» des requêtes <wordasword>echo</wordasword> en allant de la
      destination la plus proche à la plus éloignée. On débute avec l'interface
      de boucle locale (<wordasword>loopback</wordasword>), puis l'interface
      locale, puis la passerelle par défaut et enfin une adresse
      <acronym>IP</acronym> située sur un autre réseau. Ce n'est qu'en dernier
      lieu que l'on doit effectuer un test avec le service de noms de domaines
      à l'aide des commandes <command>host</command> ou
      <command>dig</command>. Enfin, si le protocole <acronym>ICMP</acronym>
      n'est pas disponible au delà du réseau local, on peut utiliser un outil
      du type <command>tcptraceroute</command> pour tester la connectivité
      inter réseau.</para>

      <para>Pour la partie analyse réseau, <application>tshark</application>
      permet d'analyser à la console le trafic passant par chacune des
      interfaces d'un routeur. Il permet notamment de caractériser le
      fonctionnement de la traduction d'adresses entre les interfaces
      <acronym>LAN</acronym> et <acronym>WAN</acronym>.</para>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>

  <sect2 xml:id='interco.ppp.qa.hub.wan'>
    <title>Connexion au réseau étendu</title>

  <para>Chaque routeur <wordasword>Hub</wordasword> utilise les deux canaux B
  d'un bus S0. On doit donc configurer deux interfaces <literal>ipppX</literal>
  pour établir les connexions point à point avec les deux
  <wordasword>Spokes</wordasword>.</para>

  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para><phrase>Quelles sont les opérations supplémentaires nécessaires à
      la configuration des interfaces <acronym>RNIS</acronym> du routeur
      <wordasword>Hub</wordasword> ?</phrase></para>

      <para>Consulter les pages de manuels de la commande
      <command>isdnctrl</command> en effectuant une recherche avec la
      clé : <literal>pppbind</literal>.</para>
      </question>
      <answer>
      <para>De façon à éviter les «croisements» entre les affectations
      d'adresses <acronym>IP</acronym> des deux
      <wordasword>Spokes</wordasword>, il est nécessaire de lier les interfaces
      réseau avec le plan de numérotation téléphonique. Par exemple, sur le
      <wordasword>Hub</wordasword> <citetitle>Centares</citetitle>, on peut
      exécuter les commandes suivantes.</para>

<screen width='80'><prompt>#</prompt> isdnctrl pppbind ippp0 0
<prompt>#</prompt> isdnctrl pppbind ippp1 1</screen>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Donner la liste des options de la commande
      <command>isdnctrl</command> pour la configuration des deux interfaces du
      <wordasword>Hub</wordasword> ?</phrase></para>

      <para>Reprendre les instructions vues dans le support &url.interco.rawip;
      et la <xref linkend='interco.ppp.qa.ppp-protocol' />.</para>
      </question>
<!--      <answer>
      </answer>-->
    </qandaentry>

    <qandaentry>
      <question>
      <para><phrase>Quelle est l'option de la commande
      <command>isdnctrl</command> qui permet de sauvegarder/restituer la
      configuration de l'interface <acronym>RNIS</acronym> ?</phrase></para>

      <para>Utiliser les pages de manuel de l'outil
      <command>isdnctrl</command>. Sauvegarder le fichier de configuration de
      l'interface pour les utilisations ultérieures.</para>
      </question>
      <answer>
      <para>Ce sont les options <option>readconf</option> et
      <option>writeconf</option> de la commande <command>isdnctrl</command>
      quit permettent respectivement de lire et d'écrire dans un fichier de
      configuration l'ensemble des paramètres d'une ou plusieurs interfaces
      <acronym>RNIS</acronym>.</para>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>
</sect1>

<sect1 xml:id='interco.ppp.qa.soho'>
  <title>Système Routeur d'agence (<wordasword>Spoke</wordasword>)</title>

    <para>Dans ce scénario, le routeur accède à Internet par son interface
    <acronym>WAN</acronym> ou <acronym>RNIS</acronym> et redistribue cet accès
    sur un réseau local. Ce genre de routeur est appelé «routeur d'agence». Il
    fait partie de la catégorie d'équipement <wordasword>Small Office Home
    Office</wordasword> ou <acronym>SOHO</acronym>.</para>

<!-- topologie du réseau TP -->
<screen width='80'>&soho.topo;
</screen>

  <sect2 xml:id='interco.ppp.qa.soho.lan'>
    <title>Connexion au réseau local</title>

  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para>Quelles sont les opérations nécessaires à la configuration de
      l'interface Ethernet ?</para>
      </question>
      <answer>
      <para>Reprendre les questions du support &url.interco.rawip;.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Quels sont les tests à réaliser pour s'assurer du fonctionnement de
      l'accès Internet ?</para>
      </question>
      <answer>
      <para>Reprendre la séquence «rituelle» des tests <acronym>ICMP</acronym>
      avec la commande <command>ping</command> et les adresses : boucle
      locale (<wordasword>loopback</wordasword>), interface locale, passerelle
      par défaut et une adresse réseau située sur un autre réseau. Ce n'est
      qu'en dernier lieu que l'on doit effectuer un test avec le service de
      noms de domaines à l'aide des commandes <command>host</command> ou
      <command>dig</command>. Enfin, si le protocole <acronym>ICMP</acronym>
      n'est pas disponible au delà du réseau local, il faut utiliser la
      commande <command>tcptraceroute</command> pour tester la connectivité
      inter réseaux.</para>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>
  
  <sect2 xml:id='interco.ppp.qa.soho.wan'>
    <title>Connexion au réseau étendu</title>

  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para>Quelles sont les opérations nécessaires à la configuration de
      l'interface <acronym>RNIS</acronym> en serveur d'appels ?</para>
      </question>
      <answer>
      <para>Reprendre les questions ci-avant</para>
<!--      : <xref
      linkend="interco.ppp.qa.protocol"/>.</para>-->
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Donner la liste des options de la commande
      <command>isdnctrl</command> pour la configuration serveur
      d'appels ?</para>
      </question>
      <answer>
      <para>Rechercher dans les documents les éléments associés à l'option
      <option>dialout</option>.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Quels sont les fichiers nécessaires à l'utilisation du démon
      <systemitem class='daemon'>ipppd</systemitem> en serveur
      d'appels ?</para>
      </question>
      <answer>
      <para>Utiliser les pages de manuels du démon
      <systemitem class='daemon'>ipppd</systemitem>.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Quelle est l'option de la commande <command>isdnctrl</command> qui
      permet de sauvegarder/restituer la configuration de l'interface
      (<acronym>RNIS</acronym>|<acronym>ISDN</acronym>) ?</para>
      </question>
      <answer>
      <para>Utiliser les pages de manuel de l'outil
      <command>isdnctrl</command>. Sauvegarder le fichier de configuration de
      l'interface pour les utilisations ultérieures.</para>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>

  <sect2 xml:id='interco.ppp.qa.soho.nat'>
    <title>Configuration du routeur d'agence
    (<wordasword>Spoke</wordasword>)</title>
   
  <qandaset defaultlabel='number'>
    <qandaentry>
      <question>
      <para>Quelle est la fonction réseau du noyau LINUX qui permet d'activer
      le routage des paquets entre les interfaces du système ?</para>
      </question>
      <answer>
      <para>Consulter le support &url.interco.kernel;.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Quelle est la fonction de filtrage utilisée pour gérer l'espace
      d'adressage tout en contrôlant les accès ?</para>
      </question>
      <answer>
      <para>Consulter le support &url.interco.kernel;.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Donner la liste des options de la commande
      <command>iptables</command> pour activer les fonctions de traduction
      d'adresses et de suivi de communication pour le routeur
      d'agence ?</para>
      </question>
      <answer>
      <para>À partir du support &url.interco.kernel; et des exemples donnés
      dans le guide &url.nat-howto;, établir une configuration simple de
      traduction d'adresse. Attention à adopter une syntaxe indépendante de
      l'adressage <acronym>IP</acronym> pour pouvoir changer de numérotation
      réseau à volonté.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Quels sont les tests à réaliser pour s'assurer du fonctionnement du
      routeur d'agence ?</para>
      </question>
      <answer>
      <para>Reprendre la séquence «rituelle» des tests <acronym>ICMP</acronym>
      en direction du poste client et de l'Internet. Visualiser aussi
      l'utilisation des règles de filtrage avec l'outil
      <command>iptables</command>. Consulter les pages de manuels de la
      commande <command>iptables</command>.</para>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>

  <sect2 xml:id='interco.ppp.qa.soho.auth'>
    <title>Authentification PPP</title>

  <qandaset>
    <qandaentry>
      <question>
      <para>Quelles sont les options de configuration du démon
      <application>ipppd</application> qui permettent d'activer
      l'authentification auprès du routeur d'accès ?</para>
      </question>
      <answer>
      <para>Consulter les pages de manuel du démon <systemitem
      class='daemon'>ipppd</systemitem> ainsi que le guide
      &url.ppp-howto;</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Quelles sont les informations contenues dans les messages système
      qui permettent de valider la connexion téléphonique ?</para>
      </question>
      <answer>
      <para>À partir du fichier <filename>/var/log/syslog</filename>, relever
      les informations relatives à la couche liaison du protocole
      <acronym>PPP</acronym> : le protocole <acronym>LCP</acronym>.</para>
      </answer>
    </qandaentry>

    <qandaentry>
      <question>
      <para>Quelles sont les informations contenues dans les messages système
      qui permettent de valider l'échange des adresses IP entre le serveur et
      le client ?</para>
      </question>
      <answer>
      <para>Toujours à partir du fichier <filename>/var/log/syslog</filename>,
      relever les informations relatives à la couche réseau du protocole
      <acronym>PPP</acronym> : le protocole
      <acronym>IPCP</acronym>.</para>
      </answer>
    </qandaentry>
  </qandaset>
  </sect2>
</sect1>

<sect1 xml:id='interco.ppp.qa.refdocs'>
  <title>Documents de référence</title>

  <variablelist>
    <varlistentry xml:id='interco.ppp.qa.rfc1661'>
      <term><citetitle>The Point-to-Point Protocol (PPP)</citetitle></term>
      <listitem>
      <para>&url.rfc1661; : Le protocole point-à-point
      <acronym>PPP</acronym> fournit une méthode standard de transport de
      datagrammes multi-protocoles sur des liaisons point à point.
      <acronym>PPP</acronym> comprend 3 composants principaux :</para>
      <orderedlist>
        <listitem>
	<para>Une méthode d'encapsulation des datagrammes
	multi-protocoles.</para>
	</listitem>
	<listitem>
	<para>Un protocole de contrôle de niveau liaison ou <wordasword>Link
	Control Protocol</wordasword> (<acronym>LCP</acronym>) pour établir,
	configurer et tester une connexion de données à ce niveau.</para>
	</listitem>
	<listitem>
	<para>Une famille de protocoles de contrôle de niveau réseau pour
	établir et configurer différents protocoles de niveau réseau.</para>
	</listitem>
      </orderedlist>
      <para>Dans la plupart des cas, on retrouve des trames
      <acronym>HDLC</acronym> au niveau liaison et <acronym>IP</acronym> est le
      seul protocole réseau utilisé.</para>
      </listitem>
    </varlistentry>

    <varlistentry xml:id='interco.ppp.qa.rawip'>
      <term><citetitle>Configuration d'une interface RNIS en mode
      rawip</citetitle></term>
      <listitem>
      <para>&url.interco.rawip; : support de travaux pratiques utilisant la
      connexion directe sur le réseau téléphonique.</para>
      </listitem>
    </varlistentry>

    <varlistentry xml:id='interco.ppp.qa.config.interface.lan'>
      <term><citetitle>Configuration d'une interface de réseau local</citetitle></term>
      <listitem>
      <para>&url.config.interface.lan; : identification du type d'interface,
      de ses caractéristiques et manipulations des paramètres. Ce support
      fournit une méthodologie de dépannage simple d'une connexion
      réseau.</para>
      </listitem>
    </varlistentry>
    
    <varlistentry xml:id='interco.ppp.qa.debian-ref.network.config'>
      <term><citetitle>Debian Reference Chapter 10 - Network
      configuration</citetitle></term>
      <listitem>
	<para>&url.debian-ref.network.config; : chapitre du manuel de
	référence <citetitle>Debian</citetitle> consacré à l'administration
	réseau.</para>
      </listitem>
    </varlistentry>

    <varlistentry xml:id='interco.ppp.qa.fonctions.noyau'>
      <term><citetitle>Fonctions réseau du noyau Linux</citetitle></term>
      <listitem>
      <para>&url.interco.kernel; : présentation et configuration des
      fonctions réseau du noyau LINUX</para>
      </listitem>
    </varlistentry>

    <varlistentry xml:id='interco.ppp.qa.nat-howto'>
      <term><citetitle>Guide Pratique du NAT sous Linux 2.4</citetitle></term>
      <listitem>
      <para>&url.nat-howto; : Ce document décrit comment réaliser du
      camouflage d'adresse <acronym>IP</acronym>, un serveur mandataire
      transparent, de la redirection de ports ou d'autres formes de traduction
      d'adresse réseau (<wordasword>Network Address Translation</wordasword> ou
      <acronym>NAT</acronym>) avec le noyau Linux 2.4.</para>
      </listitem>
    </varlistentry>

    <varlistentry xml:id='interco.ppp.qa.ppp-howto'>
      <term><citetitle>Linux PPP HOWTO</citetitle></term>
      <listitem>
      <para>&url.ppp-howto; : Ce guide est relativement ancien. On y
      trouve cependant des exemples utiles sur le paramétrage de
      l'authentification avec la protocole <acronym>PPP</acronym>.</para>
      </listitem>
    </varlistentry>
  </variablelist>
</sect1>
</article>
